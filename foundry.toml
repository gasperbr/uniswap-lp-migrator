[profile.default]
auto_detect_solc = true
src = "src"
out = "out"
test = "test"
libs = ["lib"]
via_ir = true
optimizer = true
optimizer_runs = 200
evm_version = "osaka"
ffi = true
fs_permissions = [
    { access = "read", path = "out/" },
]

remappings = [
    "@uniswap/v4-core/=lib/v4-periphery/lib/v4-core/",
    "@uniswap/v3-core/=lib/v3-core/",
    "@uniswap/v3-periphery/=lib/v3-periphery/",
    "lib/v3-periphery/:@openzeppelin/contracts/=lib/openzeppelin-contracts/contracts/",
    "lib/v4-periphery/:openzeppelin-contracts/=lib/v4-periphery/lib/v4-core/lib/openzeppelin-contracts/contracts/",
    "@openzeppelin/contracts/=lib/v4-periphery/lib/v4-core/lib/openzeppelin-contracts/contracts/",
    "permit2/=lib/v4-periphery/lib/permit2/",
    "solmate/=lib/v4-periphery/lib/v4-core/lib/solmate/",
    "forge-std/=lib/forge-std/src/",
    "v4-periphery/=lib/v4-periphery/",
    "solady/=lib/solady/src/",
    "evm-contracts/=lib/evm-contracts/",
]

# Include v4-periphery sources so we can compile PositionManager in this repo
# This is needed because Deploy.sol uses vm.getCode to load compiled artifacts
additional_compiler_profiles = [
    { name = "posm", via_ir = true, optimizer_runs = 30000 },
    { name = "no_ir", via_ir = false, evm_version = "istanbul", bytecode_hash = "None" },
    { name = "uni_v3", via_ir = false, evm_version = "istanbul", optimizer_runs = 800, bytecode_hash = "None" },
]

compilation_restrictions = [
    { paths = "lib/v4-periphery/src/PositionManager.sol", optimizer_runs = 30000 },
    { paths = "lib/v3-core/contracts/UniswapV3Pool.sol", via_ir = false, evm_version = "istanbul", optimizer_runs = 800, bytecode_hash = "None" },
    { paths = "lib/v3-core/contracts/UniswapV3Factory.sol", via_ir = false, evm_version = "istanbul", optimizer_runs = 800, bytecode_hash = "None" },
    { paths = "lib/v3-core/contracts/UniswapV3PoolDeployer.sol", via_ir = false, evm_version = "istanbul", optimizer_runs = 800, bytecode_hash = "None" },
    { paths = "lib/v3-periphery/contracts/NonfungiblePositionManager.sol", via_ir = false, evm_version = "istanbul", optimizer_runs = 800, bytecode_hash = "None" },
]

# See more config options https://github.com/foundry-rs/foundry/blob/master/crates/config/README.md#all-options
